# classes13.dex

.class public Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;
.super Ljava/lang/Object;
.source "BotClient.java"


# static fields
.field private static final client:Lokhttp3/OkHttpClient;

.field private static final executor:Ljava/util/concurrent/ExecutorService;

.field private static volatile lastBidTime:J

.field public static isPaused:Z


# direct methods
.method static constructor <clinit>()V
    .registers 1

    .line 1
    new-instance v0, Lokhttp3/OkHttpClient;

    invoke-direct {v0}, Lokhttp3/OkHttpClient;-><init>()V

    sput-object v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->client:Lokhttp3/OkHttpClient;

    const/4 v0, 0x4

    invoke-static {v0}, Ljava/util/concurrent/Executors;->newFixedThreadPool(I)Ljava/util/concurrent/ExecutorService;

    move-result-object v0

    sput-object v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->executor:Ljava/util/concurrent/ExecutorService;

    const/4 v0, 0x1
    sput-boolean v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->isPaused:Z

    return-void
.end method

.method public constructor <init>()V
    .registers 1

    .line 1
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    return-void
.end method

.method public static checkAndAct(Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;Ly41/w0;Lu41/p1;)V
    .registers 5
    .param p0, "fragment"  # Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;
    .param p1, "vm"  # Ly41/w0;
    .param p2, "order"  # Lu41/p1;

    .line 1
    const-string v0, "BotClient"

    const-string v1, "checkAndAct (Fragment) called"

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    sget-boolean v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->isPaused:Z
    if-eqz v0, :cond_bot_paused
    return-void
    :cond_bot_paused

    sget-object v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->executor:Ljava/util/concurrent/ExecutorService;

    new-instance v1, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient$Runner;

    invoke-direct {v1, p1, p2, p0}, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient$Runner;-><init>(Ly41/w0;Lu41/p1;Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;)V

    invoke-interface {v0, v1}, Ljava/util/concurrent/ExecutorService;->execute(Ljava/lang/Runnable;)V

    return-void
.end method

.method public static checkAndAct(Ly41/w0;Lu41/p1;)V
    .registers 5
    .param p0, "vm"  # Ly41/w0;
    .param p1, "order"  # Lu41/p1;

    .line 1
    const-string v0, "BotClient"

    const-string v1, "checkAndAct (VM only) called"

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    sget-boolean v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->isPaused:Z
    if-eqz v0, :cond_bot_paused_vm
    return-void
    :cond_bot_paused_vm

    sget-object v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->executor:Ljava/util/concurrent/ExecutorService;

    new-instance v1, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient$Runner;

    const/4 v2, 0x0

    invoke-direct {v1, p0, p1, v2}, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient$Runner;-><init>(Ly41/w0;Lu41/p1;Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;)V

    invoke-interface {v0, v1}, Ljava/util/concurrent/ExecutorService;->execute(Ljava/lang/Runnable;)V

    return-void
.end method

.method public static getUserId(Landroid/content/Context;)Ljava/lang/String;
    .registers 3
    .param p0, "context"  # Landroid/content/Context;

    .line 1
    invoke-virtual {p0}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;

    move-result-object v0

    const-string v1, "android_id"

    invoke-static {v0, v1}, Landroid/provider/Settings$Secure;->getString(Landroid/content/ContentResolver;Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    return-object v0
.end method

.method public static final performBid(Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;D)V
    .registers 5
    .param p0, "fragment"  # Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;
    .param p1, "price"  # D

    .line 1
    new-instance v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient$Bidder;

    invoke-direct {v0, p0, p1, p2}, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient$Bidder;-><init>(Lsinet/startup/inDriver/city/driver/order/ui/info/OrderInfoFragment;D)V

    invoke-virtual {p0}, Landroidx/fragment/app/Fragment;->getActivity()Landroidx/fragment/app/FragmentActivity;

    move-result-object v1

    if-eqz v1, :cond_e

    invoke-virtual {v1, v0}, Landroid/app/Activity;->runOnUiThread(Ljava/lang/Runnable;)V

    :cond_e
    return-void
.end method

.method public static final performDirectBid(Ly41/w0;D)V
    .registers 10
    .param p0, "viewModel"  # Ly41/w0;
    .param p1, "price"  # D

    .prologue
    .line 1
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v0

    sget-wide v2, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->lastBidTime:J

    sub-long v2, v0, v2

    const-wide/16 v4, 0xbb8

    cmp-long v2, v2, v4

    if-gez v2, :cond_16

    const-string v0, "BotClient"

    const-string v1, "Bid rejected due to cooldown (3s)"

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    return-void

    :cond_16
    sput-wide v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->lastBidTime:J

    const-string v0, "BotClient"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Performing direct bid: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, p1, p2}, Ljava/lang/StringBuilder;->append(D)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    new-instance v0, Ljava/math/BigDecimal;

    invoke-direct {v0, p1, p2}, Ljava/math/BigDecimal;-><init>(D)V

    invoke-virtual {p0}, Ly41/w0;->getOrderStore()Lo62/j0;

    move-result-object v1

    sget-object v2, Lu41/a0;->a:Lu41/a0;

    invoke-virtual {v1, v2}, Lo62/j0;->n(Ljava/lang/Object;)V

    new-instance v2, Lu41/b0;

    invoke-direct {v2, v0}, Lu41/b0;-><init>(Ljava/math/BigDecimal;)V

    invoke-virtual {v1, v2}, Lo62/j0;->n(Ljava/lang/Object;)V

    return-void
.end method

.method public static final performDirectBidWithTime(Ly41/w0;DLsinet/startup/inDriver/city/common/domain/entity/Price;I)V
    .registers 24
    .param p0, "viewModel"  # Ly41/w0;
    .param p1, "price"  # D
    .param p3, "priceEntity"  # Lsinet/startup/inDriver/city/common/domain/entity/Price;
    .param p4, "minutes"  # I

    .prologue
    .line 1
    # Alias parameters to low registers for invoke-virtual compatibility (max v15)
    move-object v10, p0
    move-wide v11, p1
    move-object v13, p3
    move v14, p4

    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v0

    sget-wide v2, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->lastBidTime:J

    sub-long v2, v0, v2

    const-wide/16 v4, 0xbb8

    cmp-long v2, v2, v4

    if-gez v2, :cond_16

    const-string v0, "BotClient"

    const-string v1, "Bid rejected due to cooldown (3s)"

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    return-void

    :cond_16
    sput-wide v0, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->lastBidTime:J

    const-string v0, "BotClient"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Performing direct bid with time: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v11, v12}, Ljava/lang/StringBuilder;->append(D)Ljava/lang/StringBuilder;

    const-string v2, " Time: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v14}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    new-instance v0, Ljava/math/BigDecimal;

    invoke-direct {v0, v11, v12}, Ljava/math/BigDecimal;-><init>(D)V

    invoke-virtual {v10}, Ly41/w0;->getOrderStore()Lo62/j0;

    move-result-object v1

    sget-object v2, Lu41/a0;->a:Lu41/a0;

    invoke-virtual {v1, v2}, Lo62/j0;->n(Ljava/lang/Object;)V

    new-instance v2, Lu41/b0;

    invoke-direct {v2, v0}, Lu41/b0;-><init>(Ljava/math/BigDecimal;)V

    invoke-virtual {v1, v2}, Lo62/j0;->n(Ljava/lang/Object;)V

    move-object v3, v0

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->f()Lsinet/startup/inDriver/city/common/domain/entity/Currency;

    move-result-object v4

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->g()Ljava/math/BigDecimal;

    move-result-object v5

    invoke-virtual {v0, v5}, Ljava/math/BigDecimal;->compareTo(Ljava/math/BigDecimal;)I

    move-result v1

    if-lez v1, :cond_clamp_skip

    move-object v5, v0

    const-string v1, "BotClient_Fix"

    const-string v2, "Upgrading Max Price to Bid Price"

    invoke-static {v1, v2}, Landroid/util/Log;->w(Ljava/lang/String;Ljava/lang/String;)I

    :cond_clamp_skip

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->d()Ljava/math/BigDecimal;

    move-result-object v6

    const-string v7, "BotClient_PriceDebug"

    new-instance v8, Ljava/lang/StringBuilder;

    invoke-direct {v8}, Ljava/lang/StringBuilder;-><init>()V

    const-string v9, "Bid Price: "

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8, v11, v12}, Ljava/lang/StringBuilder;->append(D)Ljava/lang/StringBuilder;

    const-string v9, " | Price Obj: [Val="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->i()Ljava/math/BigDecimal;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v9, ", Disc="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->g()Ljava/math/BigDecimal;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v9, ", Bonus="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v6}, Ljava/lang/Object;->toString()Ljava/lang/String; 

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v9, ", Tips="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->h()Ljava/math/BigDecimal;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v9, ", Fee="

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->e()Ljava/math/BigDecimal;

    move-result-object v9

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;

    const-string v9, "]"

    invoke-virtual {v8, v9}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v8}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v8

    invoke-static {v7, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->h()Ljava/math/BigDecimal;

    move-result-object p0 # p0 is local logic here, overwritten by p.e(). WAIT, p0 register was v19? But method signature used p0 for ViewModel. The generated code logic here seems to override p0. Oh, local vars in existing code might reuse registers.
    # Original code had p0 being overwritten? No, original had `sget-object p0` maybe? 
    # Let's check original lines roughly. `move-result-object p1` etc.
    # The original smali compiler often reuses parameter registers as scratch variables if they are not needed.
    # BUT, since I alliased parameters to v10-v14, I should be wary of registers p0-p4 being reused as locals if they are high registers.
    # Wait, p0 is v19. If I write to v19, it's fine as long as I don't need ViewModel anymore.
    # The construction of `new-instance v2, Lsinet/.../Price` takes parameters.
    # <init>(BigDecimal, Currency, BigDecimal, BigDecimal, BigDecimal, BigDecimal)
    # The arguments must be in registers.
    # I need to ensure the arguments passed to <init> are correct.

    invoke-virtual {v13}, Lsinet/startup/inDriver/city/common/domain/entity/Price;->e()Ljava/math/BigDecimal;

    move-result-object p1 

    new-instance v2, Lsinet/startup/inDriver/city/common/domain/entity/Price;

    invoke-direct/range {v2 .. v8}, Lsinet/startup/inDriver/city/common/domain/entity/Price;-><init>(Ljava/math/BigDecimal;Lsinet/startup/inDriver/city/common/domain/entity/Currency;Ljava/math/BigDecimal;Ljava/math/BigDecimal;Ljava/math/BigDecimal;Ljava/math/BigDecimal;)V

    move-object v0, v2 # Move result to v0? No, v2 is the new object. Wait, original logic: `move-object p1, v2`.
    # It reused p1 register to store the new price. Since p1 is high (v20), we should avoid using it for anything other than move-object if possible.
    # But wait, `new-instance v2, Lu41/s` takes Price. `invoke-direct {v2, p4, v3, p1}`.
    # This uses `p4` (v23) and `p1` (v20).
    # Since I have `v14` for `p4`, and `v2` holds the price.
    # I should use `v2` directly instead of moving to `p1`.
    # And use `v14` instead of `p4`.

    new-instance v3, Lu41/s;

    const/4 v4, 0x1

    invoke-direct {v3, v14, v4, v2}, Lu41/s;-><init>(IZLsinet/startup/inDriver/city/common/domain/entity/Price;)V

    invoke-virtual {v1, v3}, Lo62/j0;->n(Ljava/lang/Object;)V

    return-void
.end method

.method public static sendOrder(Ljava/lang/String;)Ljava/lang/String;
    .registers 9
    .param p0, "json"  # Ljava/lang/String;

    .line 10
    :try_start_0
    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v0

    sget-object v2, Lsinet/startup/inDriver/city/driver/order/ui/info/BotClient;->client:Lokhttp3/OkHttpClient;

    const-string v3, "application/json; charset=utf-8"

    invoke-static {v3}, Lokhttp3/MediaType;->e(Ljava/lang/String;)Lokhttp3/MediaType;

    move-result-object v3

    .line 13
    .local v3, "JSON":Lokhttp3/MediaType;
    invoke-static {v3, p0}, Lokhttp3/RequestBody;->create(Lokhttp3/MediaType;Ljava/lang/String;)Lokhttp3/RequestBody;

    move-result-object v4

    .line 15
    .local v4, "body":Lokhttp3/RequestBody;
    new-instance v5, Ljava/lang/StringBuilder;

    invoke-direct {v5}, Ljava/lang/StringBuilder;-><init>()V

    sget-object v6, Ly41/w0;->SERVER_URL:Ljava/lang/String;

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    const-string v6, "/decide"

    invoke-virtual {v5, v6}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v5}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v5

    new-instance v6, Lokhttp3/Request$Builder;

    invoke-direct {v6}, Lokhttp3/Request$Builder;-><init>()V

    invoke-virtual {v6, v5}, Lokhttp3/Request$Builder;->l(Ljava/lang/String;)Lokhttp3/Request$Builder;

    move-result-object v5

    .line 18
    invoke-virtual {v5, v4}, Lokhttp3/Request$Builder;->h(Lokhttp3/RequestBody;)Lokhttp3/Request$Builder;

    move-result-object v5

    .line 19
    invoke-virtual {v5}, Lokhttp3/Request$Builder;->b()Lokhttp3/Request;

    move-result-object v5

    .line 21
    .local v5, "request":Lokhttp3/Request;
    invoke-virtual {v2, v5}, Lokhttp3/OkHttpClient;->a(Lokhttp3/Request;)Lokhttp3/Call;

    move-result-object v2

    invoke-interface {v2}, Lokhttp3/Call;->execute()Lokhttp3/Response;

    move-result-object v2

    .line 22
    .local v2, "response":Lokhttp3/Response;
    invoke-virtual {v2}, Lokhttp3/Response;->k()Lokhttp3/ResponseBody;

    move-result-object v2

    invoke-virtual {v2}, Lokhttp3/ResponseBody;->C()Ljava/lang/String;

    move-result-object v2

    invoke-static {}, Ljava/lang/System;->currentTimeMillis()J

    move-result-wide v3

    sub-long/2addr v3, v0

    const-string v0, "ConfigDebug"

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Network Request Time: "

    invoke-virtual {v1, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v3, v4}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;

    const-string v3, "ms. Response: "

    invoke-virtual {v1, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-static {v0, v1}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
    :try_end_67
    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_67} :catch_68

    return-object v2

    .line 23
    .end local v0
    .end local v1
    .end local v2  # "response":Lokhttp3/Response;
    .end local v3  # "JSON":Lokhttp3/MediaType;
    .end local v4  # "body":Lokhttp3/RequestBody;
    :catch_68
    move-exception v0

    .line 24
    .local v0, "e":Ljava/lang/Exception;
    invoke-virtual {v0}, Ljava/lang/Exception;->printStackTrace()V

    .line 25
    const/4 v1, 0x0

    return-object v1
.end method
